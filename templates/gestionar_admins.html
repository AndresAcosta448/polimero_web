<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Gestionar Administradores</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='gestionar_admins.css') }}">
</head>

<body class="bg-light">
  <div class="d-flex">
    {% include 'sidebar.html' %}
    <div class="flex-fill">
      {% include 'navbar_admin.html' %}

      <div class="container mt-5">
        <h1>Gestionar Administradores</h1>

        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <ul class="flash-list">
              {% for category, msg in messages %}
                <li class="{{ category }}">{{ msg }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        {% endwith %}

        <form method="POST" class="row g-3 mb-4">
          <!-- Nombre -->
          <div class="col-md-4">
            <input
              class="form-control"
              name="nombre"
              placeholder="Nombre"
              required
              minlength="2"
              maxlength="20"
              pattern="^[A-Za-zÁÉÍÓÚáéíóúÑñ]{2,20}$"
              title="El nombre debe tener entre 2 y 20 letras"
              oninvalid="this.setCustomValidity('El nombre debe tener entre 2 y 20 letras')"
              oninput="this.setCustomValidity('')"
            >
          </div>

          <!-- Correo -->
          <div class="col-md-4">
            <input
              class="form-control"
              name="correo"
              placeholder="Correo electrónico"
              required
              pattern="^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.(com|es)$"
              title="Correo inválido. Formato: usuario@dominio.com o .es"
              oninvalid="this.setCustomValidity('Correo inválido. Formato: usuario@dominio.com o .es')"
              oninput="this.setCustomValidity('')"
            >
          </div>

          <!-- Contraseña -->
          <div class="col-md-4">
            <input
              type="password"
              class="form-control"
              name="contrasena"
              placeholder="Contraseña"
              required
              minlength="6"
              maxlength="10"
              pattern="^(?=.*[A-Z])(?=(.*\d){2,}).{6,10}$"
              title="Debe tener 6-10 caracteres, 1 mayúscula y 2 números"
              oninvalid="this.setCustomValidity('Debe tener 6-10 caracteres, 1 mayúscula y 2 números')"
              oninput="this.setCustomValidity('')"
            >
          </div>

          <div class="col-12">
            <button class="btn btn-success w-100">Agregar Admin</button>
          </div>
        </form>

        <table class="table table-bordered bg-white">
          <thead>
            <tr>
              <th>ID</th>
              <th>Nombre</th>
              <th>Correo</th>
              <th>Acción</th>
            </tr>
          </thead>
          <tbody>
          {% for a in admins %}
            <tr>
              <td>{{ a.id }}</td>
              <td>{{ a.nombre }}</td>
              <td>{{ a.correo }}</td>
              <td>
                <form method="POST" action="{{ url_for('eliminar_admin', id=a.id) }}" onsubmit="return confirm('¿Eliminar este administrador?');">
                  <button class="btn btn-danger btn-sm">Eliminar</button>
                </form>
              </td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>

    </div>
  </div>
</body>
</html>
